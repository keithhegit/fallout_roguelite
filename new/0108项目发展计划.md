# Wasteland Survivor é¡¹ç›®å¼€å‘è¡ŒåŠ¨çº²é¢†

> æ›´æ–°æ—¶é—´ï¼š2026-01-08  
> é¡¹ç›®ç›®å½•ï¼š`D:\Code\fallout_roguelike`  
> è¿œç¨‹ä»“åº“ï¼šhttps://github.com/keithhegit/fallout_roguelite

---

## 0. æ‰§è¡Œæ‘˜è¦ï¼ˆTL;DRï¼‰

**é¡¹ç›®ç›®æ ‡**ï¼šå°†ä¿®ä»™æ–‡å­— RPG æ¢çš®ä¸º Fallout é£æ ¼ç«–å± H5ï¼ˆPWAï¼‰ï¼Œé¢å‘è¥¿æ–¹å¸‚åœºï¼Œéƒ¨ç½²è‡³ Cloudflare Pagesã€‚

**å½“å‰çŠ¶æ€**ï¼š
- âœ… ç§»åŠ¨ç«¯éª¨æ¶ã€PWAã€è‹±æ–‡ locales åŸºç¡€å·²è½åœ°
- âœ… åºŸåœŸ UI ä¸»é¢˜æ–¹å‘å·²ç¡®ç«‹ï¼ˆPip-Boy/CRT é£æ ¼ï¼‰
- âœ… éƒ¨ç½²é“¾è·¯å¯ç”¨ï¼ˆGitHub Actions â†’ Cloudflare Pagesï¼‰
- âš ï¸ æœåŠ¡å±‚ä»æœ‰å¤§é‡ä¸­æ–‡ç¡¬ç¼–ç ï¼ˆrandomService.tsï¼‰
- âš ï¸ éƒ¨åˆ†ç»„ä»¶é£æ ¼æœªç»Ÿä¸€

**ä¸‹ä¸€é˜¶æ®µå…³é”®ä»»åŠ¡**ï¼š
1. ä¿®å¤ `randomService.ts` ä¸­æ–‡å†…å®¹ï¼ˆP0 é˜»å¡æ€§é—®é¢˜ï¼‰
2. å®Œæˆ Turn-Based Battle ä¸ Inventory çš„è§†è§‰ä¸€è‡´æ€§
3. æ¸…ç†æ®‹ç•™æ—§ä¸»é¢˜ classï¼Œç»Ÿä¸€ design tokens
4. ç¡®ä¿ i18n å®Œæ•´è¦†ç›–ï¼Œæ¶ˆé™¤ä¸­æ–‡æ³„éœ²

---

## 1. æŠ€æœ¯æ ˆä¸å·¥ç¨‹ç°çŠ¶

### 1.1 æ ¸å¿ƒæŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| å‰ç«¯æ¡†æ¶ | React + TypeScript | 19.2 / 5.8 |
| æ„å»ºå·¥å…· | Vite | 6.2 |
| æ ·å¼æ–¹æ¡ˆ | Tailwind CSS | 4.x |
| PWA | vite-plugin-pwa + workbox | 1.2 / 7.4 |
| çŠ¶æ€ç®¡ç† | React Hooks + localStorage | - |
| éƒ¨ç½²å¹³å° | Cloudflare Pages | - |

### 1.2 é¡¹ç›®ç»“æ„é€Ÿè§ˆ

```
fallout_roguelike/
â”œâ”€â”€ App.tsx                 # åº”ç”¨ä¸»å…¥å£ï¼ˆ1700+ è¡Œï¼Œæ ¸å¿ƒé€»è¾‘èšåˆï¼‰
â”œâ”€â”€ index.tsx               # React DOM æŒ‚è½½ç‚¹
â”œâ”€â”€ index.html              # HTML æ¨¡æ¿ï¼ˆå« viewportã€å­—ä½“ã€importmapï¼‰
â”œâ”€â”€ index.css               # å…¨å±€æ ·å¼
â”œâ”€â”€ components/             # UI ç»„ä»¶ï¼ˆModal/Panel ä¸ºä¸»ï¼‰
â”œâ”€â”€ views/                  # ä¸šåŠ¡è§†å›¾å±‚ï¼ˆhandlers + é¡µé¢ç»„ä»¶ï¼‰
â”œâ”€â”€ constants/              # æ¸¸æˆæ•°æ®å¸¸é‡ï¼ˆå¢ƒç•Œ/ç‰©å“/å® ç‰©ç­‰ï¼‰
â”œâ”€â”€ services/               # æœåŠ¡å±‚ï¼ˆAIäº‹ä»¶/æˆ˜æ–—/å•†åº—è§„åˆ™ï¼‰
â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰ Hooks
â”œâ”€â”€ context/                # React Contextï¼ˆLocale/UIï¼‰
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”œâ”€â”€ locales/en/             # è‹±æ–‡ç¿»è¯‘æ–‡ä»¶ï¼ˆ8 ä¸ª JSONï¼‰
â”œâ”€â”€ public/assets/          # é™æ€èµ„æº
â”œâ”€â”€ new/                    # è§„åˆ’æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼‰
â””â”€â”€ .github/workflows/      # CI/CD é…ç½®
```

### 1.3 æœ¬åœ°å¼€å‘å‘½ä»¤

```bash
pnpm install          # å®‰è£…ä¾èµ–
pnpm dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm build            # ç”Ÿäº§æ„å»º
pnpm preview          # æœ¬åœ°é¢„è§ˆç”Ÿäº§æ„å»º
pnpm lint             # ESLint æ£€æŸ¥
pnpm lint:fix         # ESLint è‡ªåŠ¨ä¿®å¤
```

### 1.4 éƒ¨ç½²é…ç½®

**GitHub Actions è‡ªåŠ¨éƒ¨ç½²**ï¼ˆä¸»è·¯å¾„ï¼‰ï¼š
- Workflow: `.github/workflows/deploy.yml`
- è§¦å‘æ¡ä»¶ï¼špush åˆ° `main`/`master` æˆ–æ‰‹åŠ¨è§¦å‘
- éƒ¨ç½²å‘½ä»¤ï¼š`wrangler pages deploy dist --project-name=wasteland-survivor`

**æ‰€éœ€ Secrets/Vars**ï¼š
| åç§° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `CLOUDFLARE_API_TOKEN` | Secret | Cloudflare API Token |
| `CLOUDFLARE_ACCOUNT_ID` | Secret | Cloudflare Account ID |
| `VITE_AI_KEY` | Secret | AI æœåŠ¡ API Key |
| `VITE_AI_PROVIDER` | Var | AI æä¾›å•†ï¼ˆglm/siliconflow/openaiï¼‰ |

---

## 2. å·²å®Œæˆå·¥ä½œæ¸…å•

### 2.1 åŸºç¡€è®¾æ–½ âœ…

| æ¨¡å— | çŠ¶æ€ | å…³é”®æ–‡ä»¶ |
|------|------|---------|
| ç§»åŠ¨ç«¯ viewport | âœ… | `index.html` |
| PWA manifest | âœ… | `vite.config.ts` |
| Service Worker | âœ… | vite-plugin-pwa è‡ªåŠ¨ç”Ÿæˆ |
| CRT è§†è§‰æ•ˆæœ | âœ… | `components/CRTOverlay.tsx` |
| åºŸåœŸä¸»é¢˜è‰² | âœ… | `tailwind.config.js` |
| i18n åŸºç¡€æ¶æ„ | âœ… | `context/LocaleContext.tsx` |
| è‹±æ–‡ç¿»è¯‘æ–‡ä»¶ | âœ… | `locales/en/*.json`ï¼ˆ8 ä¸ªæ–‡ä»¶ï¼‰ |
| èµ„æºå¸¸é‡åŒ– | âœ… | `constants/assets.ts` |
| CI/CD æµæ°´çº¿ | âœ… | `.github/workflows/deploy.yml` |

### 2.2 ç»„ä»¶ç»ˆç«¯åŒ–ï¼ˆéƒ¨åˆ†å®Œæˆï¼‰

| ç»„ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| AutoAdventureConfigModal | âœ… | æ‰«æçº¿/æœ¯è¯­/æŒ‰é’®ç»Ÿä¸€ |
| BattleModal | âœ… | æ—¥å¿—å±•ç¤ºä¸çŠ¶æ€åŒºç»Ÿä¸€ |
| CRTOverlay | âœ… | å…¨å±€æè´¨å±‚ |
| TurnBasedBattleModal | âš ï¸ | ä»æœ‰ `mystic-gold` æ®‹ç•™ |
| InventoryModal | âš ï¸ | ä»æœ‰ `mystic-gold` æ®‹ç•™ |
| å…¶ä»– Modal | âš ï¸ | é£æ ¼ä¸ç»Ÿä¸€ |

---

## 3. æ½œåœ¨å´©æºƒé—®é¢˜åˆ†æ ğŸ”´

### 3.1 [å·²ä¿®å¤] ASSETS æœªå®šä¹‰å¯¼è‡´é»‘å±

**é—®é¢˜**ï¼šç”Ÿäº§æ„å»ºåè¿è¡Œé»‘å±ï¼Œæ§åˆ¶å°æŠ¥ `ReferenceError: ASSETS is not defined`

**åŸå› **ï¼šéƒ¨åˆ†ç»„ä»¶ä½¿ç”¨äº† `ASSETS` å¸¸é‡ä½†æœªå¯¼å…¥

**ä¿®å¤çŠ¶æ€**ï¼šâœ… å·²ä¿®å¤ï¼Œ27 ä¸ªç»„ä»¶å·²æ­£ç¡®å¯¼å…¥

**éªŒè¯æ–¹æ³•**ï¼š
```bash
# æ£€æŸ¥æ˜¯å¦æ‰€æœ‰ä½¿ç”¨ ASSETS çš„ç»„ä»¶éƒ½å·²å¯¼å…¥
grep -r "ASSETS\." components/ --include="*.tsx" | grep -v "import.*ASSETS"
# åº”è¿”å›ç©ºç»“æœ
```

### 3.2 [å·²ä¿®å¤] workbox-window ä¾èµ–ç¼ºå¤±

**é—®é¢˜**ï¼šPWA æ„å»º/æ³¨å†Œç›¸å…³æµç¨‹ç¼ºä¾èµ–å¯¼è‡´æ„å»ºå¤±è´¥

**ä¿®å¤çŠ¶æ€**ï¼šâœ… å·²åœ¨ `devDependencies` ä¸­æ·»åŠ  `workbox-window: ^7.4.0`

### 3.3 [å¾…è¯„ä¼°] index.html importmap æ½œåœ¨å†²çª

**é—®é¢˜æè¿°**ï¼š`index.html` ç¬¬ 30-40 è¡Œå­˜åœ¨å¤–éƒ¨ CDN importmapï¼š

```html:30:40:index.html
<script type="importmap">
  {
    "imports": {
      "lucide-react": "https://aistudiocdn.com/lucide-react@^0.554.0",
      "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
      "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
      "react/": "https://aistudiocdn.com/react@^19.2.0/",
      "react": "https://aistudiocdn.com/react@^19.2.0"
    }
  }
</script>
```

**é£é™©åˆ†æ**ï¼š
- **å¼€å‘ç¯å¢ƒ**ï¼šVite dev server ä¼˜å…ˆä½¿ç”¨ node_modulesï¼Œimportmap è¢«å¿½ç•¥
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šVite æ‰“åŒ…æ—¶ä¼š bundle æ‰€æœ‰ä¾èµ–ï¼Œimportmap ç†è®ºä¸Šä¸ç”Ÿæ•ˆ
- **æ½œåœ¨é—®é¢˜**ï¼šå¦‚æœæµè§ˆå™¨å…ˆè§£æ importmapï¼Œå¯èƒ½å¯¼è‡´æ¨¡å—åŠ è½½å†²çª

**å»ºè®®å¤„ç†**ï¼š
```html
<!-- æ–¹æ¡ˆ Aï¼šåˆ é™¤æ•´ä¸ª importmapï¼ˆæ¨èï¼‰ -->
<!-- æ–¹æ¡ˆ Bï¼šä¿ç•™ä½†æ·»åŠ æ¡ä»¶æ³¨é‡Š -->
```

**éªŒè¯æ–¹æ³•**ï¼š
```bash
pnpm build && pnpm preview
# æ‰“å¼€æµè§ˆå™¨ DevTools â†’ Networkï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ä» aistudiocdn.com åŠ è½½çš„è¯·æ±‚
# å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜ importmap æœªç”Ÿæ•ˆï¼Œå¯ä»¥å®‰å…¨åˆ é™¤
```

### 3.4 [å¾…ä¿®å¤] æœåŠ¡å±‚ä¸­æ–‡ç¡¬ç¼–ç  ğŸ”´ **æœ€é«˜ä¼˜å…ˆçº§**

**é—®é¢˜æè¿°**ï¼š`services/randomService.ts` ä¸­å­˜åœ¨å¤§é‡ä¸­æ–‡å­—ç¬¦ä¸²

**å½±å“èŒƒå›´**ï¼š

| å˜é‡ | è¡Œå· | å†…å®¹ç±»å‹ | å½±å“ |
|------|------|---------|------|
| `DROP_ITEMS` | 127-147 | æ‰è½ç‰©åç§° | æ—¥å¿—/å¥–åŠ±æ˜¾ç¤ºä¸­æ–‡ |
| `SECT_DATA` | 149-169 | å®—é—¨åç§°+æè¿° | æ´¾ç³»ç•Œé¢æ˜¾ç¤ºä¸­æ–‡ |
| `TASK_NAMES_BY_TYPE` | 171-201 | ä»»åŠ¡åç§° | æ´¾ç³»ä»»åŠ¡æ˜¾ç¤ºä¸­æ–‡ |
| `TASK_DESCRIPTIONS_BY_TYPE` | 203-345 | ä»»åŠ¡æè¿° | æ´¾ç³»ä»»åŠ¡æ˜¾ç¤ºä¸­æ–‡ |
| `ITEM_POOLS` | 368-376 | ç‰©å“æ±  | ä»»åŠ¡æˆæœ¬/å¥–åŠ±æ˜¾ç¤ºä¸­æ–‡ |

**å½“å‰çŠ¶æ€**ï¼š
- `REALM_NAMES_BY_RISK`ï¼šâœ… å·²è‹±æ–‡åŒ–ï¼ˆç¬¬ 8-33 è¡Œï¼‰
- `REALM_DESCRIPTIONS_BY_RISK`ï¼šâœ… å·²è‹±æ–‡åŒ–ï¼ˆç¬¬ 35-125 è¡Œï¼‰

**ä¿®å¤æ–¹æ¡ˆ**ï¼šè¯¦è§ 4.1.1 èŠ‚

---

## 4. å¾…åŠäº‹é¡¹è¯¦ç»†æ–¹æ¡ˆ

### 4.1 P0 - é˜»å¡æ€§é—®é¢˜ï¼ˆå¿…é¡»åœ¨ä¸‹æ¬¡éƒ¨ç½²å‰ä¿®å¤ï¼‰

#### 4.1.1 ä¿®å¤ randomService.ts ä¸­æ–‡å†…å®¹

**ä»»åŠ¡æè¿°**ï¼šå°† `services/randomService.ts` ä¸­å‰©ä½™çš„ä¸­æ–‡å­—ç¬¦ä¸²æ›¿æ¢ä¸ºè‹±æ–‡åºŸåœŸä¸»é¢˜

**Step 1ï¼šä¿®å¤ DROP_ITEMSï¼ˆç¬¬ 127-147 è¡Œï¼‰**

```typescript
// å½“å‰ï¼ˆä¸­æ–‡ï¼‰
const DROP_ITEMS = [
  'å¦–å…½ææ–™', 'ç¨€æœ‰è‰è¯', 'æ”»å‡»æ³•å™¨', 'å‰‘ä¿®åŠŸæ³•', 'æ®‹ç ´çµå®',
  'å‰‘æ„è‰', 'é›·å±æ€§è‡³å®', 'ä»™å“ä¸¹è¯ææ–™', 'å¤©é˜¶åŠŸæ³•', 'ä¸Šå¤é—ç‰©',
  'çµå…½å†…ä¸¹', 'ç‚¼å™¨ææ–™', 'ç¬¦ç®“', 'é˜µæ³•å›¾', 'ä¼ æ‰¿ç‰ç®€',
  'ä»™è‰', 'çµçŸ¿', 'æ³•å®ç¢ç‰‡',
];

// ä¿®å¤åï¼ˆè‹±æ–‡åºŸåœŸä¸»é¢˜ï¼‰
const DROP_ITEMS = [
  'Mutant Parts', 'Rare Herbs', 'Weapon Mod', 'Combat Manual', 'Damaged Relic',
  'Stimulant Plant', 'Fusion Core', 'Chem Components', 'Advanced Schematics', 'Pre-War Artifact',
  'Mutant Gland', 'Crafting Materials', 'Tech Blueprint', 'Circuit Diagram', 'Data Holotape',
  'Medicinal Herb', 'Rare Mineral', 'Weapon Fragment',
];
```

**Step 2ï¼šä¿®å¤ SECT_DATAï¼ˆç¬¬ 149-169 è¡Œï¼‰**

```typescript
// å½“å‰ï¼ˆä¸­æ–‡ï¼‰
const SECT_DATA: Array<{ name: string; description: string }> = [
  { name: 'äº‘çµå®—', description: 'æ­£é“å¤§å®—ï¼Œé—¨é£æ¸…æ­£ï¼Œé€‚åˆå¤§éƒ¨åˆ†ä¿®å£«ã€‚' },
  // ... æ›´å¤š
];

// ä¿®å¤åï¼ˆè‹±æ–‡åºŸåœŸä¸»é¢˜ï¼‰
const SECT_DATA: Array<{ name: string; description: string }> = [
  { name: 'Haven Outpost', description: 'A peaceful survivor settlement. Welcomes most wastelanders.' },
  { name: 'Inferno Gang', description: 'Perched atop a volcano. Masters of fire, ruthless in action.' },
  { name: 'Steel Brotherhood', description: 'One weapon breaks all. Members are combat fanatics with extreme firepower.' },
  { name: 'The Sanctuary', description: 'A holy refuge. Compassionate healers with outstanding defense.' },
  { name: 'Tech Cult', description: 'Pre-war tech worshippers. Extremely fast research progress.' },
  { name: 'Blood Raiders', description: 'A violent raider faction. Ruthless but powerful.' },
  { name: 'Blade Runners', description: 'Melee combat specialists. Exquisite close-quarters techniques.' },
  { name: 'Vault Dwellers United', description: 'Alliance of vault survivors. Deep resources and knowledge.' },
  { name: 'Shadow Syndicate', description: 'Underground network. Cunning and resourceful.' },
  { name: 'Starlight Enclave', description: 'Mysterious organization. Harnesses stellar radiation.' },
  { name: 'Dragonblood Tribe', description: 'Descendants of the enhanced. Powerful genetic heritage.' },
  { name: 'Phoenix Rising', description: 'Rebirth through radiation. Masters of regeneration.' },
  { name: 'Thunder Legion', description: 'Specialists in energy weapons. Extreme firepower.' },
  { name: 'Cryo Corps', description: 'Ice element specialists. Strong defensive capabilities.' },
  { name: 'Venom Valley', description: 'Poison experts. Masters of chemical warfare.' },
  { name: 'Mirage Order', description: 'Illusionists. Experts at misdirection and confusion.' },
  { name: 'Iron Temple', description: 'Physical enhancement focus. Incredibly tough bodies.' },
  { name: 'Balance Collective', description: 'Harmony of offense and defense. Well-rounded fighters.' },
];
```

**Step 3ï¼šä¿®å¤ TASK_NAMES_BY_TYPEï¼ˆç¬¬ 171-201 è¡Œï¼‰**

```typescript
const TASK_NAMES_BY_TYPE: Record<TaskType, string[]> = {
  patrol: ['Perimeter Patrol', 'Outpost Watch', 'Border Patrol', 'Security Sweep'],
  donate_stone: ['Contribute Caps', 'Donate Supplies', 'Fund the Outpost'],
  donate_herb: ['Donate Chems', 'Contribute Medical Supplies', 'Provide Stimpaks'],
  collect: ['Gather Materials', 'Resource Collection', 'Scavenge Supplies'],
  hunt: ['Mutant Hunt', 'Creature Elimination', 'Beast Extermination', 'Clear the Zone'],
  alchemy: ['Craft Chems', 'Med Production', 'Synthesize Stimpaks', 'Brew Chemicals'],
  forge: ['Weapon Crafting', 'Forge Equipment', 'Build Gear', 'Manufacture Arms'],
  teach: ['Train Recruits', 'Combat Training', 'Share Knowledge', 'Mentor Newbies'],
  defend: ['Defend Outpost', 'Guard Duty', 'Perimeter Defense', 'Fortification Watch'],
  explore: ['Explore Ruins', 'Ruin Expedition', 'Site Investigation', 'Recon Mission'],
  trade: ['Trade Escort', 'Caravan Guard', 'Trade Mission', 'Commerce Run'],
  research: ['Research Tech', 'Tech Analysis', 'Study Schematics', 'Data Analysis'],
  cultivate: ['Farm Crops', 'Tend Greenhouse', 'Grow Medicinal Plants', 'Agriculture Duty'],
  maintain: ['Maintain Defenses', 'Repair Systems', 'Generator Maintenance', 'Fix Turrets'],
  diplomacy: ['Diplomatic Mission', 'Faction Liaison', 'Alliance Talks', 'Peace Negotiation'],
  trial: ['Combat Trial', 'Proving Grounds', 'Challenge Test', 'Skill Assessment'],
  rescue: ['Rescue Mission', 'Save Allies', 'Emergency Extraction', 'Search and Rescue'],
  investigate: ['Investigation', 'Intel Gathering', 'Recon Task', 'Scout Mission'],
  battle: ['Arena Combat', 'Sparring Match', 'Combat Practice', 'Prove Your Worth'],
  treasure_hunt: ['Treasure Hunt', 'Relic Search', 'Artifact Recovery', 'Lost Tech Quest'],
  escort: ['VIP Escort', 'Protect the Elder', 'Supply Escort', 'Protection Detail'],
  assassination: ['Elimination Target', 'Neutralize Threat', 'Covert Ops', 'Silent Strike'],
  artifact_repair: ['Repair Artifact', 'Restore Relic', 'Tech Restoration', 'Fix Equipment'],
  spirit_beast: ['Tame Creature', 'Capture Mutant', 'Beast Bond', 'Find Companion'],
  sect_war: ['Faction War', 'Territory Battle', 'Offensive Operation', 'War Campaign'],
  inheritance: ['Legacy Trial', 'Inherit Knowledge', 'Prove Worthy', 'Succession Test'],
  tribulation: ['Rad Storm Survival', 'Tribulation Trial', 'Storm Mission', 'Endurance Test'],
  alchemy_master: ['Master Chemist', 'Craft Legendary Chem', 'Chemistry Challenge', 'Expert Synthesis'],
};
```

**Step 4ï¼šä¿®å¤ TASK_DESCRIPTIONS_BY_TYPEï¼ˆç¬¬ 203-345 è¡Œï¼‰**

> ç”±äºå†…å®¹è¾ƒé•¿ï¼Œå»ºè®®ä½¿ç”¨ç±»ä¼¼çš„åºŸåœŸä¸»é¢˜æ›¿æ¢æ‰€æœ‰ä¸­æ–‡æè¿°ã€‚ç¤ºä¾‹ï¼š

```typescript
const TASK_DESCRIPTIONS_BY_TYPE: Record<TaskType, string[]> = {
  patrol: [
    'Patrol the perimeter and eliminate any hostiles.',
    'Sweep the outpost borders for threats.',
    'Maintain security in the surrounding area.',
  ],
  donate_stone: [
    'Contribute caps to support outpost development.',
    'Donate supplies for contribution points.',
    'Fund the daily operations of the outpost.',
  ],
  // ... ç»§ç»­æ›¿æ¢å…¶ä»–ç±»å‹
};
```

**Step 5ï¼šä¿®å¤ ITEM_POOLSï¼ˆç¬¬ 368-376 è¡Œï¼‰**

```typescript
// å½“å‰ï¼ˆä¸­æ–‡ï¼‰
const ITEM_POOLS = {
  herbs: ['èšçµè‰', 'ç´«çŒ´èŠ±', 'å¤©çµè‰', 'è¡€å‚', 'çµèŠ'],
  materials: ['ç‚¼å™¨çŸ³', 'å¦–å…½å†…ä¸¹', 'çµçŸ¿', 'ç¬¦çº¸', 'ç²¾é“', 'ç„é“', 'æ˜Ÿè¾°çŸ³'],
  // ...
};

// ä¿®å¤åï¼ˆè‹±æ–‡åºŸåœŸä¸»é¢˜ï¼‰
const ITEM_POOLS = {
  herbs: ['Healing Herb', 'Mutfruit', 'Glowing Fungus', 'Bloodleaf', 'Brain Fungus'],
  materials: ['Scrap Metal', 'Mutant Gland', 'Rare Mineral', 'Circuit Board', 'Steel', 'Tungsten', 'Star Core'],
  alchemy: ['Healing Herb', 'Mutfruit', 'Glowing Fungus', 'Bloodleaf'],
  forge: ['Scrap Metal', 'Steel', 'Rare Mineral', 'Mutant Gland'],
  maintain: ['Scrap Metal', 'Circuit Board', 'Rare Mineral'],
  repair: ['Scrap Metal', 'Steel', 'Tungsten', 'Star Core'],
  masterAlchemy: ['Pure Water', 'Rare Isotope', 'Quantum Particle', 'Fusion Cell'],
};
```

**éªŒè¯æ–¹æ³•**ï¼š
```bash
# ä¿®å¤åæ‰§è¡Œï¼Œåº”è¿”å› 0 åŒ¹é…
grep -c "[\u4e00-\u9fa5]" services/randomService.ts
```

#### 4.1.2 éªŒè¯ ASSETS å¯¼å…¥å®Œæ•´æ€§

**ä»»åŠ¡æè¿°**ï¼šç¡®ä¿æ‰€æœ‰ä½¿ç”¨ `ASSETS` çš„ç»„ä»¶éƒ½å·²æ­£ç¡®å¯¼å…¥

**éªŒè¯è„šæœ¬**ï¼š
```bash
# æŸ¥æ‰¾ä½¿ç”¨ ASSETS ä½†æœªå¯¼å…¥çš„æ–‡ä»¶
for file in $(grep -rl "ASSETS\." components/ views/ --include="*.tsx"); do
  if ! grep -q "import.*ASSETS" "$file"; then
    echo "Missing import: $file"
  fi
done
```

**å½“å‰çŠ¶æ€**ï¼š27 ä¸ªç»„ä»¶å·²æ­£ç¡®å¯¼å…¥ï¼Œé€šè¿‡éªŒè¯

---

### 4.2 P1 - é«˜ä¼˜å…ˆçº§ï¼ˆç”¨æˆ·ä½“éªŒå…³é”®ï¼‰

#### 4.2.1 Turn-Based Battle ç»ˆç«¯åŒ–

**å½“å‰é—®é¢˜**ï¼š`components/TurnBasedBattleModal.tsx` ç¬¬ 598-599 è¡Œä»ä½¿ç”¨ `mystic-gold`

```typescript
// å½“å‰ï¼ˆç¬¬ 598-599 è¡Œï¼‰
<div className="flex items-center gap-2 text-lg font-serif text-mystic-gold">
  <Sword size={18} className="text-mystic-gold" />
```

**ä¿®å¤æ–¹æ¡ˆ**ï¼šç»Ÿä¸€ä¸ºåºŸåœŸä¸»é¢˜è‰²

```typescript
// ä¿®å¤å
<div className="flex items-center gap-2 text-lg font-terminal text-amber-400">
  <Sword size={18} className="text-amber-400" />
```

**å®Œæ•´ç»ˆç«¯åŒ–æ”¹é€ æ£€æŸ¥æ¸…å•**ï¼š
- [ ] Header åŒºåŸŸï¼šç»Ÿä¸€å­—ä½“ã€é¢œè‰²ã€è¾¹æ¡†
- [ ] ç©å®¶/æ•ŒäººçŠ¶æ€åŒºï¼šç»Ÿä¸€ä¿¡æ¯å¯†åº¦
- [ ] æ“ä½œæŒ‰é’®ï¼šç»Ÿä¸€ä¸ºåºŸåœŸé£æ ¼ï¼ˆ`bg-bunker-800 border-toxic-500` ç­‰ï¼‰
- [ ] æ—¥å¿—åŒºåŸŸï¼šç»Ÿä¸€æ»šåŠ¨åŒºæ ·å¼
- [ ] ç»“æœå±•ç¤ºï¼šä¸ BattleModal ä¿æŒä¸€è‡´

#### 4.2.2 Inventory/Equipment ç‰©å“å¡ä½“ç³»

**å½“å‰é—®é¢˜**ï¼š`components/InventoryModal.tsx` ç¬¬ 294ã€428 è¡Œä½¿ç”¨ `mystic-gold`

**ä¿®å¤æ–¹æ¡ˆ**ï¼š

```typescript
// ç¬¬ 294 è¡Œ - æœ¬å‘½æ³•å®æ ‡è¯†
// å½“å‰
<div className="text-xs text-mystic-gold mb-2 flex items-center gap-1">

// ä¿®å¤å
<div className="text-xs text-amber-400 mb-2 flex items-center gap-1">

// ç¬¬ 428 è¡Œ - æœ¬å‘½æ³•å®æŒ‰é’®
// å½“å‰
? 'bg-ink-950 hover:bg-mystic-gold/10 text-mystic-gold border-mystic-gold/50'

// ä¿®å¤å
? 'bg-bunker-900 hover:bg-amber-500/10 text-amber-400 border-amber-500/50'
```

**ç‰©å“å¡ä½“ç³»è§„èŒƒ**ï¼š

| ç¨€æœ‰åº¦ | è¾¹æ¡†è‰² | æ–‡å­—è‰² | èƒŒæ™¯å‘å…‰ |
|-------|-------|-------|---------|
| Common | `border-steel-500` | `text-steel-400` | æ—  |
| Rare | `border-blue-500` | `text-blue-400` | `shadow-blue-500/20` |
| Legendary | `border-purple-500` | `text-purple-400` | `shadow-purple-500/20` |
| Mythic | `border-amber-500` | `text-amber-400` | `shadow-amber-500/30` |

#### 4.2.3 æ—§ä¸»é¢˜ Class å…¨å±€æ¸…ç†

**å½“å‰çŠ¶æ€**ï¼š154 å¤„ä½¿ç”¨ `mystic-gold|jade-|cultivation-`ï¼Œåˆ†å¸ƒåœ¨ 31 ä¸ªæ–‡ä»¶

**åˆ†æ**ï¼š
- `mystic-gold` å·²åœ¨ `tailwind.config.js` ä¸­æ˜ å°„åˆ° `#f59e0b`ï¼ˆamberï¼‰
- å±äº"å…¼å®¹æ€§ä¿ç•™"è€Œé"éœ€åˆ é™¤"
- ä½†ä¸ºäº†ä»£ç ä¸€è‡´æ€§ï¼Œå»ºè®®ç»Ÿä¸€ä¸ºåºŸåœŸè¯­ä¹‰å‘½å

**æ‰¹é‡æ›¿æ¢æ–¹æ¡ˆ**ï¼š

```bash
# Step 1: æŸ¥çœ‹æ‰€æœ‰ä½¿ç”¨ä½ç½®
grep -rn "mystic-gold" components/ views/ --include="*.tsx"

# Step 2: åˆ¶å®šæ›¿æ¢æ˜ å°„
# mystic-gold â†’ amber-400 æˆ– amber-500ï¼ˆæ ¹æ®ä¸Šä¸‹æ–‡ï¼‰
# mystic-jade â†’ toxic-400 æˆ– toxic-500
# mystic-blood â†’ rust-400 æˆ– rust-500

# Step 3: ä½¿ç”¨ IDE å…¨å±€æ›¿æ¢ï¼ˆæ¨èï¼‰æˆ– sed
# æ³¨æ„ï¼šéœ€è¦äººå·¥å®¡æ ¸æ¯å¤„æ›¿æ¢ï¼Œå› ä¸ºè¯­ä¹‰å¯èƒ½ä¸åŒ
```

**ä¼˜å…ˆçº§æ’åº**ï¼ˆå…ˆæ”¹æœ€å¸¸è§ç•Œé¢ï¼‰ï¼š
1. `InventoryModal.tsx`ï¼ˆ2 å¤„ï¼‰
2. `TurnBasedBattleModal.tsx`ï¼ˆ2 å¤„ï¼‰
3. `CharacterModal.tsx`ï¼ˆ12 å¤„ï¼‰
4. `GrottoModal.tsx`ï¼ˆ30 å¤„ï¼‰
5. å…¶ä»–ç»„ä»¶

---

### 4.3 P2 - ä¸­ä¼˜å…ˆçº§ï¼ˆè´¨é‡é—¨ç¦ï¼‰

#### 4.3.1 ESLint è­¦å‘Šæ¸…é›¶

**å½“å‰çŠ¶æ€**ï¼šESLint é…ç½®ä¸º `warn` çº§åˆ«ï¼Œå­˜åœ¨ä»¥ä¸‹ç±»å‹è­¦å‘Šï¼š
- `@typescript-eslint/no-explicit-any`
- `prefer-const`
- `@typescript-eslint/no-unused-vars`

**å¤„ç†ç­–ç•¥**ï¼š
```bash
# Step 1: æŸ¥çœ‹è­¦å‘Šç»Ÿè®¡
pnpm lint 2>&1 | grep -E "warning|error" | wc -l

# Step 2: è‡ªåŠ¨ä¿®å¤å¯è‡ªåŠ¨å¤„ç†çš„é—®é¢˜
pnpm lint:fix

# Step 3: æ‰‹åŠ¨å¤„ç†å‰©ä½™é—®é¢˜
# ä¼˜å…ˆå¤„ç† no-unused-varsï¼ˆåˆ é™¤æ— ç”¨ä»£ç ï¼‰
# å…¶æ¬¡å¤„ç† prefer-constï¼ˆlet â†’ constï¼‰
# æœ€åå¤„ç† no-explicit-anyï¼ˆéœ€è¦ä»”ç»†è¯„ä¼°ç±»å‹ï¼‰
```

#### 4.3.2 TypeScript ä¸¥æ ¼æ¨¡å¼ï¼ˆé•¿æœŸç›®æ ‡ï¼‰

**å½“å‰çŠ¶æ€**ï¼š`tsconfig.json` æœªå¯ç”¨ `strict` æ¨¡å¼

**å»ºè®®è·¯å¾„**ï¼š
1. å…ˆå¯ç”¨ `strictNullChecks`
2. å†å¯ç”¨ `noImplicitAny`
3. æœ€åå¯ç”¨å®Œæ•´ `strict`

```json
// tsconfig.json æ¸è¿›å¼æ”¹é€ 
{
  "compilerOptions": {
    // Phase 1
    "strictNullChecks": true,
    // Phase 2
    "noImplicitAny": true,
    // Phase 3 (æœ€ç»ˆç›®æ ‡)
    "strict": true
  }
}
```

#### 4.3.3 i18n å®Œæ•´æ€§æ£€æŸ¥

**æ£€æŸ¥æ¸…å•**ï¼š
- [ ] `locales/en/` ä¸‹ 8 ä¸ªæ–‡ä»¶è¦†ç›–æ‰€æœ‰ UI æ–‡æœ¬
- [ ] æ— ç¡¬ç¼–ç ä¸­æ–‡å­—ç¬¦ä¸²ï¼ˆé™¤æ³¨é‡Šå¤–ï¼‰
- [ ] AI äº‹ä»¶ç”Ÿæˆé»˜è®¤è‹±æ–‡è¾“å‡º

**éªŒè¯è„šæœ¬**ï¼š
```bash
# æ£€æŸ¥ç»„ä»¶ä¸­çš„ä¸­æ–‡ï¼ˆæ’é™¤æ³¨é‡Šï¼‰
grep -rn "[\u4e00-\u9fa5]" components/ views/ --include="*.tsx" | grep -v "//"
```

---

### 4.4 P3 - ä½ä¼˜å…ˆçº§ï¼ˆé”¦ä¸Šæ·»èŠ±ï¼‰

#### 4.4.1 ç»“æ„åŒ–æ—¥å¿—å±•ç¤º

å°†"çº¯æ–‡å­—æ—¥å¿—å †å "å‡çº§ä¸º"å¯æ‰«æçš„ç»“æ„åŒ–å¡ç‰‡"ï¼š
- äº‹ä»¶ç±»å‹å›¾æ ‡
- é£é™©/å¥–åŠ±æ ‡ç­¾
- é¢œè‰²åˆ†çº§ï¼ˆç»¿è‰²æ”¶ç›Š/çº¢è‰²å±é™©/é»„è‰²ä¸­æ€§ï¼‰

#### 4.4.2 æ‰è½/å‡çº§åŠ¨æ•ˆ

- ç¨€æœ‰åº¦é—ªçƒæ•ˆæœ
- æ‹¾å–å¼¹å‡ºæ¡åŠ¨ç”»
- å‡çº§è¿›åº¦æ¡åŠ¨æ•ˆ

#### 4.4.3 ä¸­æ–‡ locale æ”¯æŒ

åˆ›å»º `locales/zh/` ç›®å½•ï¼Œé•œåƒè‹±æ–‡ç»“æ„ï¼Œæ”¯æŒåŒè¯­åˆ‡æ¢ã€‚

---

## 5. å¼€å‘ä¼˜å…ˆçº§çŸ©é˜µ

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | é¢„è®¡å·¥æ—¶ | é˜»å¡å…³ç³» |
|-------|------|---------|---------|
| **P0** | randomService ä¸­æ–‡ä¿®å¤ | 2-3h | é˜»å¡ä¸Šçº¿ |
| **P0** | ASSETS å¯¼å…¥éªŒè¯ | 30min | é˜»å¡ä¸Šçº¿ |
| **P1** | TurnBasedBattle ç»ˆç«¯åŒ– | 2h | - |
| **P1** | Inventory ç‰©å“å¡ä½“ç³» | 3h | - |
| **P1** | æ—§ä¸»é¢˜ class æ¸…ç† | 2h | ä¾èµ– P1 |
| **P2** | ESLint è­¦å‘Šæ¸…é›¶ | 2h | - |
| **P2** | i18n å®Œæ•´æ€§æ£€æŸ¥ | 1h | ä¾èµ– P0 |
| **P3** | ç»“æ„åŒ–æ—¥å¿— | 4h | - |
| **P3** | åŠ¨æ•ˆå¢å¼º | 4h | - |

---

## 6. äº¤æ¥æ¸…å•

### 6.1 ç¯å¢ƒå˜é‡é…ç½®

**æœ¬åœ°å¼€å‘**ï¼ˆ`.env.local`ï¼Œä¸æäº¤ï¼‰ï¼š
```bash
VITE_AI_PROVIDER=glm
VITE_AI_KEY=your-api-key-here
# å¯é€‰
# VITE_AI_API_URL=https://custom-gateway.example.com/v1
```

**Cloudflare Pages**ï¼š
åœ¨ Dashboard â†’ é¡¹ç›® â†’ Settings â†’ Environment Variables é…ç½®åŒåå˜é‡ã€‚

### 6.2 å†’çƒŸæµ‹è¯•æµç¨‹

```bash
# 1. ç¯å¢ƒå‡†å¤‡
pnpm install

# 2. å¼€å‘æœåŠ¡å™¨å¯åŠ¨
pnpm dev

# 3. æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•ï¼ˆæ‰‹åŠ¨ï¼‰
# - æ–°å¼€å±€ â†’ åˆ›å»ºè§’è‰²
# - æ¢ç´¢ â†’ è§¦å‘äº‹ä»¶/æˆ˜æ–—
# - æ‰“å¼€èƒŒåŒ… â†’ ä½¿ç”¨ç‰©å“
# - è§¦å‘çªç ´
# - æ£€æŸ¥æ˜¯å¦æœ‰ä¸­æ–‡æ³„éœ²

# 4. ç”Ÿäº§æ„å»ºéªŒè¯
pnpm build
pnpm preview

# 5. ESLint æ£€æŸ¥
pnpm lint
```

### 6.3 éƒ¨ç½²éªŒè¯

```bash
# æ¨é€åˆ° main åˆ†æ”¯åï¼š
# 1. æ£€æŸ¥ GitHub Actions æ˜¯å¦æˆåŠŸ
# 2. è®¿é—® https://wasteland-survivor.pages.dev
# 3. æ‰§è¡Œå†’çƒŸæµ‹è¯•æµç¨‹
```

---

## 7. å‚è€ƒæ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | è·¯å¾„ | è¯´æ˜ |
|-----|------|------|
| æ¶æ„è¯´æ˜ | `doc/ARCHITECTURE.md` | ç³»ç»Ÿæ¶æ„è®¾è®¡ |
| æ¨¡å—è¯´æ˜ | `doc/MODULES.md` | ä»£ç æ¨¡å—åˆ’åˆ† |
| å­˜æ¡£æ ¼å¼ | `doc/SAVE_FORMAT.md` | localStorage æ•°æ®ç»“æ„ |
| é¢˜æè®¾è®¡ | `new/é¢˜ææ”¹ç‰ˆåˆç¨¿.md` | ä¿®ä»™â†’åºŸåœŸæ˜ å°„å­—å…¸ |
| UI è®¡åˆ’ | `new/H5ç§»åŠ¨ç«¯UIä¸ç¾æœ¯å‡çº§è®¡åˆ’.md` | ç§»åŠ¨ç«¯ UI è§„èŒƒ |
| å·¥ç¨‹è®¡åˆ’ | `new/implementation_plan.md` | å®æ–½é˜¶æ®µåˆ’åˆ† |
| ç¾æœ¯èµ„æº | `new/UIä¸ç¾æœ¯ç´ æåˆ—è¡¨.md` | CDN èµ„æº URL æ¸…å• |

---

## 8. ç‰ˆæœ¬å†å²

| æ—¥æœŸ | ç‰ˆæœ¬ | å˜æ›´è¯´æ˜ |
|-----|------|---------|
| 2026-01-08 | v2.0 | é‡æ„ä¸ºè¯¦ç»†å¼€å‘è¡ŒåŠ¨çº²é¢†ï¼Œå¢åŠ  step-by-step æ–¹æ¡ˆ |
| 2026-01-08 | v1.0 | åˆç‰ˆäº¤æ¥æ–‡æ¡£ |
