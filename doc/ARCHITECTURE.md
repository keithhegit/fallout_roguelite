# ğŸ—ï¸ æ¶æ„è®¾è®¡æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜é¡¹ç›®çš„æ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹å’Œæ ¸å¿ƒè®¾è®¡æ¨¡å¼ã€‚

## ğŸ“ æ•´ä½“æ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æµè§ˆå™¨å®¢æˆ·ç«¯                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   React UI   â”‚  â”‚  çŠ¶æ€ç®¡ç†     â”‚  â”‚  æœ¬åœ°å­˜å‚¨     â”‚ â”‚
â”‚  â”‚   Components â”‚  â”‚  (Hooks)     â”‚  â”‚ (localStorage)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ HTTP/HTTPS
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vercel Serverless                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         API Proxy (api/proxy.js)                 â”‚  â”‚
â”‚  â”‚  - å¤„ç†è·¨åŸŸé—®é¢˜                                   â”‚  â”‚
â”‚  â”‚  - è½¬å‘ API è¯·æ±‚                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ API Request
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI API (å¤šæä¾›å•†æ”¯æŒ)                        â”‚
â”‚  - GLM (æ™ºè°±) - é»˜è®¤æä¾›å•†                                â”‚
â”‚  - SiliconFlow - Qwen2.5-72B-Instruct æ¨¡å‹              â”‚
â”‚  - OpenAI - GPT ç³»åˆ—æ¨¡å‹                                 â”‚
â”‚  - ç”Ÿæˆæ¸¸æˆäº‹ä»¶å’Œå‰§æƒ…                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯

| æŠ€æœ¯         | ç‰ˆæœ¬    | ç”¨é€”     |
| ------------ | ------- | -------- |
| React        | 19.2.0  | UI æ¡†æ¶  |
| TypeScript   | 5.8.2   | ç±»å‹ç³»ç»Ÿ |
| Vite         | 6.2.0   | æ„å»ºå·¥å…· |
| Lucide React | 0.554.0 | å›¾æ ‡åº“   |

### æœåŠ¡ä¸ API

| æœåŠ¡             | ç”¨é€”           |
| ---------------- | -------------- |
| AI API (å¤šæä¾›å•†) | AI äº‹ä»¶ç”Ÿæˆï¼ˆGLM/SiliconFlow/OpenAIï¼‰ |
| Vercel Functions | API ä»£ç†å’Œéƒ¨ç½² |
| localStorage     | æ•°æ®æŒä¹…åŒ–     |

## ğŸ“ é¡¹ç›®ç»“æ„

é¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œä¸»è¦ç›®å½•å¦‚ä¸‹ï¼š

```
react-xiuxian-game/
â”œâ”€â”€ components/     # UI ç»„ä»¶å±‚ï¼ˆçº¯å±•ç¤ºç»„ä»¶ï¼‰
â”œâ”€â”€ views/          # è§†å›¾å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ + UI ç»„åˆï¼‰
â”œâ”€â”€ hooks/          # é€šç”¨ Hooksï¼ˆçŠ¶æ€ç®¡ç†ã€å‰¯ä½œç”¨å¤„ç†ï¼‰
â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘æœåŠ¡å±‚ï¼ˆAIã€æˆ˜æ–—ç­‰ï¼‰
â”œâ”€â”€ config/         # é…ç½®æ–‡ä»¶ï¼ˆAI é…ç½®ç­‰ï¼‰
â”œâ”€â”€ api/            # API ä»£ç†å±‚ï¼ˆVercel Functionsï¼‰
â”œâ”€â”€ doc/            # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ assets/         # é™æ€èµ„æº
```

è¯¦ç»†çš„ç›®å½•ç»“æ„å’Œæ¨¡å—è¯´æ˜è¯·å‚è€ƒ [æ¨¡å—è§£ææ–‡æ¡£](./MODULES.md)ã€‚

## ğŸ›ï¸ æ¶æ„å±‚æ¬¡

### 1. è¡¨ç¤ºå±‚ (Presentation Layer)

**ä½ç½®**: `components/`

**èŒè´£**:

- UI æ¸²æŸ“
- ç”¨æˆ·äº¤äº’å¤„ç†
- è§†è§‰åé¦ˆ

**ç‰¹ç‚¹**:

- çº¯å‡½æ•°ç»„ä»¶ï¼ˆFunctional Componentsï¼‰
- æ— ä¸šåŠ¡é€»è¾‘ï¼Œåªè´Ÿè´£å±•ç¤º
- é€šè¿‡ props æ¥æ”¶æ•°æ®å’Œå›è°ƒ

**ç¤ºä¾‹ç»„ä»¶**:

```typescript
// components/StatsPanel.tsx
interface StatsPanelProps {
  player: PlayerStats;
  onOpenModal: (modal: string) => void;
}
```

### 2. è§†å›¾å±‚ (View Layer)

**ä½ç½®**: `views/`

**èŒè´£**:

- ç»„åˆ UI ç»„ä»¶
- å¤„ç†ç”¨æˆ·äº¤äº’
- è°ƒç”¨ä¸šåŠ¡é€»è¾‘ Handlers

**ç‰¹ç‚¹**:

- ä½¿ç”¨è‡ªå®šä¹‰ Hooks (`useXxxHandlers`) å°è£…ä¸šåŠ¡é€»è¾‘
- é€šè¿‡ Handlers ä¸ä¸šåŠ¡é€»è¾‘å±‚äº¤äº’
- ä¿æŒç»„ä»¶çº¯å‡€ï¼Œä¸šåŠ¡é€»è¾‘åœ¨ Handlers ä¸­

**æ¨¡å—åŒ–ç»„ç»‡**:

æ¯ä¸ªåŠŸèƒ½æ¨¡å—åŒ…å«ï¼š

- `index.ts` - æ¨¡å—å¯¼å‡º
- `useXxxHandlers.ts` - ä¸šåŠ¡é€»è¾‘å¤„ç†å‡½æ•°

**ç¤ºä¾‹**:

```typescript
// views/shop/useShopHandlers.ts
export function useShopHandlers({ player, setPlayer, addLog }) {
  const handleBuyItem = useCallback((item: Item) => {
    // ä¸šåŠ¡é€»è¾‘
  }, [player]);

  return { handleBuyItem, handleSellItem };
}
```

### 3. ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)

**ä½ç½®**: `services/`, `utils/`

**èŒè´£**:

- æ¸¸æˆè§„åˆ™å®ç°
- AI äº‹ä»¶ç”Ÿæˆ
- æˆ˜æ–—è®¡ç®—
- æ•°æ®è½¬æ¢å’Œå·¥å…·å‡½æ•°

**ç‰¹ç‚¹**:

- çº¯å‡½æ•°æˆ–ç±»æ–¹æ³•
- æ— å‰¯ä½œç”¨ï¼ˆé™¤äº† API è°ƒç”¨ï¼‰
- å¯æµ‹è¯•æ€§å¼º

**æ ¸å¿ƒæœåŠ¡**:

#### services/adventureTemplateService.ts

- `generateEventTemplateLibrary()` - ç”Ÿæˆäº‹ä»¶æ¨¡æ¿åº“
- `getRandomEventTemplate()` - è·å–éšæœºäº‹ä»¶æ¨¡æ¿
- `templateToAdventureResult()` - å°†æ¨¡æ¿è½¬æ¢ä¸ºå†ç»ƒç»“æœ

#### services/templateService.ts

- `generateBreakthroughDescriptionLibrary()` - ç”Ÿæˆçªç ´æè¿°æ¨¡æ¿åº“
- `getRandomBreakthroughDescription()` - è·å–éšæœºçªç ´æè¿°
- `generateEnemyNameLibrary()` - ç”Ÿæˆæ•Œäººåç§°æ¨¡æ¿åº“
- `getRandomEnemyName()` - è·å–éšæœºæ•Œäººåç§°

#### services/battleService.ts

- `shouldTriggerBattle()` - åˆ¤æ–­æ˜¯å¦è§¦å‘æˆ˜æ–—
- `resolveBattleEncounter()` - è§£ææˆ˜æ–—ç»“æœ
- `createEnemy()` - åˆ›å»ºæ•Œäºº

#### utils/

- `gameUtils.ts` - æ¸¸æˆé€šç”¨å·¥å…·å‡½æ•°
- `itemUtils.ts` - ç‰©å“ç›¸å…³å·¥å…·å‡½æ•°
- `playerUtils.ts` - ç©å®¶ç›¸å…³å·¥å…·å‡½æ•°

### 5. çŠ¶æ€ç®¡ç†å±‚ (State Management Layer)

**ä½ç½®**: `hooks/useGameState.ts`, `App.tsx`

**èŒè´£**:

- å…¨å±€çŠ¶æ€ç®¡ç†
- æ•°æ®æŒä¹…åŒ–
- çŠ¶æ€åŒæ­¥

**ç‰¹ç‚¹**:

- ä½¿ç”¨è‡ªå®šä¹‰ Hook å°è£…çŠ¶æ€é€»è¾‘
- å•ä¸€æ•°æ®æºï¼ˆSingle Source of Truthï¼‰
- è‡ªåŠ¨ä¿å­˜åˆ° localStorage

**æ ¸å¿ƒ Hooks**:

- `useGameState` - æ¸¸æˆçŠ¶æ€ç®¡ç†ï¼ˆç©å®¶ã€æ—¥å¿—ã€è®¾ç½®ç­‰ï¼‰
- `useGameEffects` - æ¸¸æˆå‰¯ä½œç”¨å¤„ç†ï¼ˆè‡ªåŠ¨ä¿å­˜ã€æˆå°±æ£€æŸ¥ç­‰ï¼‰
- `useAppState` - åº”ç”¨çŠ¶æ€ç®¡ç†ï¼ˆå¼¹çª—ã€å•†åº—ã€æˆ˜æ–—ç­‰ï¼‰
- `useAutoFeatures` - è‡ªåŠ¨åŠŸèƒ½ï¼ˆè‡ªåŠ¨æ‰“åã€è‡ªåŠ¨å†ç»ƒï¼‰
- `useDeathDetection` - æ­»äº¡æ£€æµ‹å’Œå¤„ç†
- `useBattleResultHandler` - æˆ˜æ–—ç»“æœå¤„ç†
- `usePassiveRegeneration` - è¢«åŠ¨å›è¡€å’Œå†·å´ç®¡ç†

### 6. é…ç½®å±‚ (Configuration Layer)

**ä½ç½®**: `config/`

**èŒè´£**:

- AI æœåŠ¡é…ç½®
- ç¯å¢ƒå˜é‡ç®¡ç†
- å¤šæä¾›å•†æ”¯æŒ

**ç‰¹ç‚¹**:

- æ”¯æŒå¤šç§ AI æä¾›å•†ï¼ˆGLMã€SiliconFlowã€OpenAI ç­‰ï¼‰
- é»˜è®¤ä½¿ç”¨ GLMï¼ˆæ™ºè°±ï¼‰ä½œä¸º AI æä¾›å•†
- ç¯å¢ƒå˜é‡é…ç½®
- çµæ´»çš„é…ç½®ç³»ç»Ÿ
- æ”¯æŒä»£ç†æ¨¡å¼å’Œç›´è¿æ¨¡å¼

**æ•°æ®æµ**:

```
ç”¨æˆ·æ“ä½œ â†’ View Handlers â†’ Features/Services â†’ æ›´æ–°çŠ¶æ€ â†’ è§¦å‘é‡æ¸²æŸ“ â†’ UI æ›´æ–°
                â†“
           ä¿å­˜åˆ° localStorage (é€šè¿‡ useGameEffects)
```

## ğŸ”„ æ•°æ®æµ

### çŠ¶æ€ç®¡ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æ“ä½œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ View Layer  â”‚ (views/*/useXxxHandlers.ts)
â”‚ Handlers    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature/    â”‚ (features/* æˆ– services/*)
â”‚ Service     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ›´æ–°çŠ¶æ€     â”‚ (useGameState Hook)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚              â”‚
       â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è§¦å‘é‡æ¸²æŸ“   â”‚  â”‚ è‡ªåŠ¨ä¿å­˜     â”‚
â”‚ (React)     â”‚  â”‚ (useGameEffects)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI æ›´æ–°    â”‚ (Components)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API è°ƒç”¨æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"å†ç»ƒ"
    â”‚
    â–¼
views/adventure/useAdventureHandlers.ts: handleAdventure()
    â”‚
    â–¼
services/aiService.ts: generateAdventureEvent()
    â”‚
    â–¼
config/aiConfig.ts: è·å– AI é…ç½®ï¼ˆGLM/SiliconFlow/OpenAIï¼‰
    â”‚
    â–¼
fetch() â†’ Vercel Function (/api/proxy) æˆ–ç›´æ¥è°ƒç”¨ API
    â”‚
    â–¼
AI API (GLM/SiliconFlow/OpenAI ç­‰)
    â”‚
    â–¼
è¿”å› JSON æ•°æ®
    â”‚
    â–¼
è§£æå¹¶æ›´æ–°æ¸¸æˆçŠ¶æ€ (é€šè¿‡ useGameState)
```

## ğŸ¨ è®¾è®¡æ¨¡å¼

### 1. ç»„ä»¶ç»„åˆæ¨¡å¼ (Composition)

ä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿æ¥æ„å»º UIï¼š

```typescript
<Modal>
  <ModalHeader />
  <ModalBody>
    <InventoryList />
  </ModalBody>
  <ModalFooter />
</Modal>
```

### 2. å—æ§ç»„ä»¶æ¨¡å¼ (Controlled Components)

æ‰€æœ‰è¡¨å•è¾“å…¥éƒ½æ˜¯å—æ§çš„ï¼š

```typescript
const [playerName, setPlayerName] = useState('');
<input
  value={playerName}
  onChange={(e) => setPlayerName(e.target.value)}
/>
```

### 3. å®¹å™¨/å±•ç¤ºç»„ä»¶æ¨¡å¼

- **å®¹å™¨ç»„ä»¶**: `App.tsx` - åè°ƒå„æ¨¡å—ï¼Œç®¡ç†å…¨å±€çŠ¶æ€
- **è§†å›¾ç»„ä»¶**: `views/*` - ç»„åˆ UI ç»„ä»¶ï¼Œå¤„ç†ç”¨æˆ·äº¤äº’
- **å±•ç¤ºç»„ä»¶**: `components/*` - çº¯ UI ç»„ä»¶

### 4. æœåŠ¡å±‚æ¨¡å¼

å°†ä¸šåŠ¡é€»è¾‘ä»ç»„ä»¶ä¸­åˆ†ç¦»åˆ°æœåŠ¡å±‚å’Œ Handlersï¼š

```typescript
// âŒ ä¸å¥½çš„åšæ³•ï¼šä¸šåŠ¡é€»è¾‘åœ¨ç»„ä»¶ä¸­
const handleAdventure = () => {
  const result = await fetch('/api/...');
  // å¤æ‚çš„å¤„ç†é€»è¾‘...
};

// âœ… å¥½çš„åšæ³•ï¼šä¸šåŠ¡é€»è¾‘åœ¨ Handlers å’ŒæœåŠ¡å±‚
// views/adventure/useAdventureHandlers.ts
const handleAdventure = async () => {
  const result = await generateAdventureEvent(player);
  // æ›´æ–°çŠ¶æ€
  setPlayer(updatedPlayer);
};
```

## ğŸ” æ•°æ®æŒä¹…åŒ–

### localStorage ç»“æ„

```typescript
// å­˜æ¡£æ•°æ®
{
  player: PlayerStats,      // ç©å®¶æ•°æ®
  logs: LogEntry[],        // æ¸¸æˆæ—¥å¿—
  timestamp: number        // ä¿å­˜æ—¶é—´æˆ³
}

// è®¾ç½®æ•°æ®
{
  soundEnabled: boolean,
  musicEnabled: boolean,
  autoSave: boolean,
  // ...
}
```

### è‡ªåŠ¨ä¿å­˜æœºåˆ¶

```typescript
useEffect(() => {
  if (player && gameStarted && settings.autoSave) {
    saveGame(player, logs);
  }
}, [player, logs, settings.autoSave]);
```

## ğŸŒ è·¨åŸŸå¤„ç†

### å¼€å‘ç¯å¢ƒ

ä½¿ç”¨ Vite ä»£ç†ï¼š

```typescript
// vite.config.ts
server: {
  proxy: {
    '/api': {
      target: 'https://spark-api-open.xf-yun.com',
      changeOrigin: true,
    }
  }
}
```

### ç”Ÿäº§ç¯å¢ƒ

ä½¿ç”¨ Vercel Serverless Functionï¼š

```javascript
// api/proxy.js
export default async function handler(req, res) {
  // å¤„ç† CORS
  // è½¬å‘è¯·æ±‚
  // è¿”å›ç»“æœ
}
```

## ğŸ§ª å¯æµ‹è¯•æ€§è®¾è®¡

### çº¯å‡½æ•°

æœåŠ¡å±‚çš„å‡½æ•°éƒ½æ˜¯çº¯å‡½æ•°ï¼Œæ˜“äºæµ‹è¯•ï¼š

```typescript
// âœ… å¯æµ‹è¯•
export const calcDamage = (attack: number, defense: number) => {
  // çº¯å‡½æ•°ï¼Œæ— å‰¯ä½œç”¨
};

// âŒ éš¾ä»¥æµ‹è¯•
const handleAdventure = async () => {
  // ä¾èµ–å¤–éƒ¨çŠ¶æ€å’Œ API
};
```

### ä¾èµ–æ³¨å…¥

é€šè¿‡å‚æ•°ä¼ é€’ä¾èµ–ï¼Œè€Œéç¡¬ç¼–ç ï¼š

```typescript
// âœ… å¯æµ‹è¯•
export const generateAdventureEvent = async (
  player: PlayerStats,
  adventureType: AdventureType
) => {
  // ä¾èµ–é€šè¿‡å‚æ•°ä¼ å…¥
};

// âŒ éš¾ä»¥æµ‹è¯•
export const generateAdventureEvent = async () => {
  const player = getPlayerFromGlobalState(); // ç¡¬ç¼–ç ä¾èµ–
};
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. React.memo

å¯¹é¢‘ç¹æ¸²æŸ“çš„ç»„ä»¶ä½¿ç”¨ `React.memo`ï¼š

```typescript
export default React.memo(StatsPanel);
```

### 2. useCallback

ç¼“å­˜å›è°ƒå‡½æ•°ï¼š

```typescript
const handleAdventure = useCallback(async () => {
  // ...
}, [player, loading]);
```

### 3. useMemo

ç¼“å­˜è®¡ç®—ç»“æœï¼š

```typescript
const totalAttack = useMemo(() => {
  return baseAttack + equipmentBonus;
}, [baseAttack, equipmentBonus]);
```

### 4. ä»£ç åˆ†å‰²

ä½¿ç”¨åŠ¨æ€å¯¼å…¥ï¼š

```typescript
const HeavyComponent = lazy(() => import('./HeavyComponent'));
```

## ğŸ”’ å®‰å…¨æ€§

### 1. API Key ç®¡ç†

- å¼€å‘ç¯å¢ƒï¼šå¯ä»¥ä½¿ç”¨ç¡¬ç¼–ç ï¼ˆä»…ç”¨äºå¼€å‘ï¼‰
- ç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨ç¯å¢ƒå˜é‡

### 2. è¾“å…¥éªŒè¯

æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯ï¼š

```typescript
const handleStartGame = (playerName: string) => {
  if (!playerName || playerName.trim().length === 0) {
    // éªŒè¯å¤±è´¥
    return;
  }
  // ...
};
```

### 3. XSS é˜²æŠ¤

React è‡ªåŠ¨è½¬ä¹‰ç”¨æˆ·è¾“å…¥ï¼Œé˜²æ­¢ XSS æ”»å‡»ã€‚

## ğŸš€ æ‰©å±•æ€§

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ·»åŠ æ–°ç»„ä»¶**: åœ¨ `components/` ç›®å½•åˆ›å»ºï¼ˆçº¯ UI ç»„ä»¶ï¼‰
2. **æ·»åŠ æ–°è§†å›¾**: åœ¨ `views/` ç›®å½•åˆ›å»ºæ¨¡å—ï¼ˆåŒ…å« Handlersï¼‰
3. **æ·»åŠ æ–° Hook**: åœ¨ `hooks/` ç›®å½•åˆ›å»ºï¼ˆå¯å¤ç”¨åŠŸèƒ½ï¼‰
4. **æ·»åŠ æ–°æœåŠ¡**: åœ¨ `services/` ç›®å½•åˆ›å»ºï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
5. **æ·»åŠ æ–°å·¥å…·å‡½æ•°**: åœ¨ `utils/` ç›®å½•åˆ›å»º
6. **æ·»åŠ æ–°ç±»å‹**: åœ¨ `types.ts` ä¸­å®šä¹‰
7. **æ·»åŠ æ–°å¸¸é‡**: åœ¨ `constants.ts` ä¸­å®šä¹‰

### æ·»åŠ æ–°å¢ƒç•Œ

```typescript
// types.ts
export enum RealmType {
  // ... ç°æœ‰å¢ƒç•Œ
  NewRealm = 'æ–°å¢ƒç•Œ',
}

// constants.ts
export const REALM_DATA: Record<RealmType, {...}> = {
  // ... ç°æœ‰æ•°æ®
  [RealmType.NewRealm]: { ... },
};
```

## ğŸ“ æ€»ç»“

é¡¹ç›®é‡‡ç”¨**åˆ†å±‚æ¶æ„**ï¼Œæ¸…æ™°åˆ†ç¦»å…³æ³¨ç‚¹ï¼š

- **è¡¨ç¤ºå±‚**: è´Ÿè´£ UI æ¸²æŸ“
- **ä¸šåŠ¡é€»è¾‘å±‚**: è´Ÿè´£æ¸¸æˆè§„åˆ™
- **æ•°æ®å±‚**: è´Ÿè´£çŠ¶æ€ç®¡ç†å’ŒæŒä¹…åŒ–

è¿™ç§æ¶æ„ä½¿å¾—ä»£ç ï¼š

- âœ… æ˜“äºç»´æŠ¤
- âœ… æ˜“äºæµ‹è¯•
- âœ… æ˜“äºæ‰©å±•
- âœ… èŒè´£æ¸…æ™°

---

**ç›¸å…³æ–‡æ¡£**:

- [æ¨¡å—è§£æ](./MODULES.md) - è¯¦ç»†çš„æ¨¡å—è¯´æ˜
- [API æ–‡æ¡£](./API.md) - API ä½¿ç”¨è¯´æ˜
- [å¼€å‘æŒ‡å—](./DEVELOPMENT.md) - å¼€å‘å®è·µ
